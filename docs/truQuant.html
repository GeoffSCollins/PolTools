

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>truQuant &mdash; GC_bioinfo 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tsrFinder" href="tsrFinder.html" />
    <link rel="prev" title="Track Links From Bigwigs" href="track_links_from_bw.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> GC_bioinfo
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="TES_combined_heatmap.html"><em>TES Combined Heatmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="TES_fold_change_heatmap.html"><em>TES Fold Change Heatmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="TES_heatmap.html"><em>TES Heatmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="base_distribution.html"><em>Base Distribution</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="gene_body_combined_heatmap.html"><em>Gene Body Combined Heatmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="gene_body_fold_change_heatmap.html"><em>Gene Body Fold Change Heatmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="gene_body_heatmap.html"><em>Gene Body Heatmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="make_regions_file_centered_on_max_tss.html"><em>Make Regions File Centered on Max TSS</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="metaplot.html"><em>Metaplot</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="multicoverage.html"><em>Multicoverage</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="nucleotide_heatmap.html"><em>Nucleotide Heatmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="pausing_distance_distribution_from_maxTSS.html"><em>Pausing Distance Distribution from Max TSS</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="read_through_transcription.html"><em>Read Through Transcription</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="region_combined_heatmap.html"><em>Region Combined Heatmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="region_fold_change_heatmap.html"><em>Region Fold Change Heatmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="region_heatmap.html"><em>Region Heatmap</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="sequence_from_region_around_max_tss.html"><em>Sequence from Around Max TSS</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="sequence_searches.html"><em>Sequence Searches</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="tps_distance_per_gene.html"><em>TPS Distance Per Gene</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="track_links_from_bw.html"><em>Track Links From Bigwigs</em></a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><em>truQuant</em></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#usage-and-option-summary">Usage and option summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#behavior">Behavior</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tsrFinder.html"><em>tsrFinder</em></a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GC_bioinfo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li><em>truQuant</em></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="truquant">
<h1><em>truQuant</em><a class="headerlink" href="#truquant" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">truQuant</span></code> tool is used to build an annotation of transcribed genes from PRO-Seq data. It also quantifies the
pause regions and gene bodies from the generated annotation while blacklisting enhancers, downstream promoters, and
non RNA Polymerase II transcripts.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tool requires <a class="reference external" href="https://github.com/arq5x/bedtools2">bedtools</a> be installed.</p>
</div>
<div class="section" id="usage-and-option-summary">
<h2>Usage and option summary<a class="headerlink" href="#usage-and-option-summary" title="Permalink to this headline">¶</a></h2>
<p><strong>Usage</strong>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">truQuant</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">a</span> <span class="p">[</span><span class="n">annotation_extension</span><span class="p">]]</span>
              <span class="p">[</span><span class="o">-</span><span class="n">b</span> <span class="p">[</span><span class="n">blacklisting_percent</span><span class="p">]]</span>
              <span class="p">[</span><span class="o">-</span><span class="n">r</span> <span class="p">[</span><span class="n">pause_region_radius</span><span class="p">]]</span> <span class="p">[</span><span class="o">-</span><span class="n">t</span> <span class="p">[</span><span class="n">threads</span><span class="p">]]</span>
              <span class="n">sequencing_file_for_annotation</span>
              <span class="p">[</span><span class="n">sequencing_files</span> <span class="p">[</span><span class="n">sequencing_files</span> <span class="o">...</span><span class="p">]]</span>
</pre></div>
</div>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Required Arguments</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Sequencing file for annotation</strong></p></td>
<td><p>Bed formatted file from a sequencing experiment.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Optional Arguments</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>-a, –annotation_extension</strong></p></td>
<td><p>Distance of base pairs to extend the 5’ end of all genes upstream. Default is 1000.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>-b, –blacklisting_percent</strong></p></td>
<td><p>Percentage (number between 0 and 1) of reads in the pause region that is necessary to blacklist a TSR in the gene body. For example, a pause region with
100 reads and a blacklist percentage of 0.3 means a TSR in the gene body needs at least 30 reads to be blacklisted. Default is 0.3.</p></td>
</tr>
<tr class="row-even"><td><p><strong>-r, –pause_region_radius</strong></p></td>
<td><p>Base pair amount to go upstream and downstream centered on the avgTSS. The pause region will be of size 2 * pause region radius. Default is 75.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>-t, –threads</strong></p></td>
<td><p>Maximum number of threads to run truQuant. Default is the max available on the system. Please note that truQuant will use a maximum of 46 threads
for finding TSRs and a one thread for each sequencing file (these two processes do not happen at the same time).</p></td>
</tr>
<tr class="row-even"><td><p><strong>Sequencing Files</strong></p></td>
<td><p>Additional sequencing files can be provided to be quantified using the generated annotation. The files will be blacklisted then quantified using the
number of 5’ end reads in the pause region and the number of 3’ end reads in the gene body.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="behavior">
<h2>Behavior<a class="headerlink" href="#behavior" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">truQuant</span></code> will generate search regions 1000 bp upstream of the 5’ end of protein coding genes from GENCODE v32. Then,
<a class="reference external" href="https://geoffscollins.github.io/GC_bioinfo/tsrFinder.html">tsrFinder</a> will be run to determine the max TSR in the search region. Inside this TSR, the max TSS will be chosen as the
annotated 5’ end. The pause region will be the 150 bp region surrounding the weighted average TSS (avgTSS) and gene body
will be the end of the pause region to the TES. TSRs in the gene with more than 30% of the reads as the max TSR will be
blacklisted. 5’ ends in the pause regions will be quantified and 3’ ends in the gene bodies will be quantified.</p>
<img alt="_images/truQuant.png" src="_images/truQuant.png" />
<p>For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ head -n <span class="m">5</span> seq_file.bed
chr1    <span class="m">11981</span>   <span class="m">12023</span>   A00876:119:HW5F5DRXX:1:2168:2248:1407   <span class="m">255</span>     -
chr1    <span class="m">13099</span>   <span class="m">13117</span>   A00876:119:HW5F5DRXX:1:2203:31403:26757 <span class="m">255</span>     -
chr1    <span class="m">13356</span>   <span class="m">13423</span>   A00876:119:HW5F5DRXX:1:2151:15808:7827  <span class="m">255</span>     -
chr1    <span class="m">13435</span>   <span class="m">13477</span>   A00876:119:HW5F5DRXX:1:2273:15781:19241 <span class="m">255</span>     -
chr1    <span class="m">13739</span>   <span class="m">13772</span>   A00876:119:HW5F5DRXX:1:2256:29966:10520 <span class="m">255</span>     -

$ GC_bioinfo truQuant seq_file.bed
$ head -n <span class="m">1</span> control-truQuant_output.txt
Gene    Chromosome      Pause Region Left       Pause Region Right      Strand  Total <span class="m">5</span><span class="s1">&#39; Reads  MaxTSS  MaxTSS 5&#39;</span> Reads Weighted Pause Region Center    STDEV of TSSs   Gene Body Left  Gene Body Right Gene Body Distance      seq_file.bed Pause Region   seq_file.bed Gene Body
NOC2L   chr1    <span class="m">959177</span>  <span class="m">959327</span>  -       <span class="m">194</span>     <span class="m">959255</span>  <span class="m">46</span>      <span class="m">959250</span>  <span class="m">13</span>.306459171023036      <span class="m">944203</span>  <span class="m">959177</span>  <span class="m">14974</span>   <span class="m">194</span>     <span class="m">18</span>
KLHL17  chr1    <span class="m">960552</span>  <span class="m">960702</span>  +       <span class="m">234</span>     <span class="m">960632</span>  <span class="m">27</span>      <span class="m">960626</span>  <span class="m">25</span>.417791063821863      <span class="m">960702</span>  <span class="m">965719</span>  <span class="m">5017</span>    <span class="m">234</span>     <span class="m">17</span>
PLEKHN1 chr1    <span class="m">966439</span>  <span class="m">966589</span>  +       <span class="m">25</span>      <span class="m">966521</span>  <span class="m">8</span>       <span class="m">966513</span>  <span class="m">19</span>.47408534437497       <span class="m">966589</span>  <span class="m">975865</span>  <span class="m">9276</span>    <span class="m">25</span>      <span class="m">11</span>
HES4    chr1    <span class="m">1000013</span> <span class="m">1000163</span> -       <span class="m">239</span>     <span class="m">1000096</span> <span class="m">87</span>      <span class="m">1000086</span> <span class="m">27</span>.14758979723915       <span class="m">998962</span>  <span class="m">1000013</span> <span class="m">1051</span>    <span class="m">239</span>     <span class="m">68</span>
ISG15   chr1    <span class="m">1000204</span> <span class="m">1000354</span> +       <span class="m">160</span>     <span class="m">1000295</span> <span class="m">12</span>      <span class="m">1000278</span> <span class="m">36</span>.24344768368484       <span class="m">1000354</span> <span class="m">1014540</span> <span class="m">14186</span>   <span class="m">160</span>     <span class="m">111</span>
AGRN    chr1    <span class="m">1020042</span> <span class="m">1020192</span> +       <span class="m">112</span>     <span class="m">1020119</span> <span class="m">35</span>      <span class="m">1020116</span> <span class="m">25</span>.189637892253575      <span class="m">1020192</span> <span class="m">1056118</span> <span class="m">35926</span>   <span class="m">112</span>     <span class="m">76</span>
RNF223  chr1    <span class="m">1074208</span> <span class="m">1074358</span> -       <span class="m">32</span>      <span class="m">1074306</span> <span class="m">10</span>      <span class="m">1074284</span> <span class="m">32</span>.567238138964136      <span class="m">1070967</span> <span class="m">1074208</span> <span class="m">3241</span>    <span class="m">32</span>      <span class="m">8</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="tsrFinder.html" class="btn btn-neutral float-right" title="tsrFinder" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="track_links_from_bw.html" class="btn btn-neutral float-left" title="Track Links From Bigwigs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Geoff Collins.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>